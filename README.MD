# KNN Paralelo con MPI - Pr√°ctica Dirigida 02

[![Python](https://img.shields.io/badge/python-3.6+-blue.svg)](https://www.python.org/downloads/)
[![MPI](https://img.shields.io/badge/MPI-mpi4py-green.svg)](https://mpi4py.readthedocs.io/)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

Implementaci√≥n paralela del algoritmo K-Nearest Neighbors (KNN) para clasificaci√≥n de d√≠gitos usando MPI, desarrollada para el curso de Applied High Performance Computing de UTEC.

## üìÅ Estructura del Proyecto

```
knn-parallel-mpi/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ knn_digits_parallel.py     # Implementaci√≥n paralela principal
‚îÇ   ‚îú‚îÄ‚îÄ knn_digits_sequential.py   # Versi√≥n secuencial de referencia
‚îÇ   ‚îî‚îÄ‚îÄ compare_sequential_parallel.py  # Comparaci√≥n de rendimiento
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ knn_digits.sh             # Script SLURM individual
‚îÇ   ‚îú‚îÄ‚îÄ run_experiments.sh        # Automatizaci√≥n de experimentos
‚îÇ   ‚îî‚îÄ‚îÄ setup_environment.sh      # Configuraci√≥n del entorno
‚îú‚îÄ‚îÄ analysis/
‚îÇ   ‚îú‚îÄ‚îÄ analyze_results.py        # An√°lisis completo de resultados
‚îÇ   ‚îî‚îÄ‚îÄ plot_utils.py             # Utilidades de visualizaci√≥n
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ INSTRUCTIONS.md           # Instrucciones detalladas
‚îÇ   ‚îî‚îÄ‚îÄ THEORY.md                 # Fundamentos te√≥ricos
‚îú‚îÄ‚îÄ requirements.txt              # Dependencias Python
‚îî‚îÄ‚îÄ README.md                     # Este archivo
```

## üöÄ Inicio R√°pido

### 1. Clonar el Repositorio
```bash
git clone https://github.com/ChristianMonrroy/knn-parallel-mpi.git
cd knn-parallel-mpi
```

### 2. Configurar Entorno (en Cluster Khipu)
```bash
# Cargar m√≥dulos y configurar entorno
chmod +x scripts/setup_environment.sh
./scripts/setup_environment.sh
```

### 3. Ejecutar Experimentos
```bash
# Experimento individual
sbatch --ntasks=4 scripts/knn_digits.sh 2

# Todos los experimentos de escalabilidad
chmod +x scripts/run_experiments.sh
./scripts/run_experiments.sh
```

### 4. Analizar Resultados
```bash
python3 analysis/analyze_results.py
python3 src/compare_sequential_parallel.py
```

## üìä Experimentos Incluidos

### Escalabilidad Fuerte
- **Dataset fijo**: multiplicador = 4 (‚âà7,188 muestras)
- **Procesos**: 1, 2, 4, 8, 16
- **Objetivo**: Analizar speedup con recursos crecientes

### Escalabilidad D√©bil  
- **Datos proporcionales**: multiplicador ‚âà n√∫mero de procesos
- **Configuraciones**: (p=1,mult=1), (p=2,mult=2), ..., (p=16,mult=16)
- **Objetivo**: Verificar condici√≥n te√≥rica n_tr ‚àº p√ólog(p)

## üìà M√©tricas Analizadas

- **‚è±Ô∏è Tiempos**: Total, distribuci√≥n, c√≥mputo, comunicaci√≥n
- **üöÄ Speedup**: S(p) = T(1)/T(p)
- **‚ö° Eficiencia**: E(p) = S(p)/p
- **üéØ Precisi√≥n**: Accuracy del modelo KNN
- **üìê Validaci√≥n te√≥rica**: Ajuste del modelo T(n,p) = a + (n√ók)/p + b√ólog(p)

## üõ†Ô∏è Requisitos del Sistema

### Software Necesario
- Python 3.6+
- MPI (MPICH o OpenMPI)
- SLURM (para cluster)

### Dependencias Python
```
mpi4py>=3.0
numpy>=1.19
scikit-learn>=0.24
matplotlib>=3.3
pandas>=1.3
```

## üìã Uso Detallado

### Experimento Individual
```bash
# Sintaxis: sbatch --ntasks=PROCESOS scripts/knn_digits.sh MULTIPLICADOR
sbatch --ntasks=8 scripts/knn_digits.sh 4

# Monitorear progreso
squeue -u $USER

# Ver resultados
cat logs/knn_digits_*.log
```

### Configuraci√≥n Personalizada
```bash
# Editar par√°metros en knn_digits_parallel.py
k = 3                    # N√∫mero de vecinos
test_size_ratio = 0.2    # Porcentaje para prueba

# Editar recursos en knn_digits.sh
#SBATCH --time=00:20:00  # Tiempo m√°ximo
#SBATCH --ntasks=8       # N√∫mero de procesos
```

## üìä Resultados Esperados

### Archivos Generados
- `results/results_p{P}_mult{M}.txt`: Datos num√©ricos por experimento
- `logs/knn_digits_*.log`: Logs de ejecuci√≥n SLURM  
- `knn_analysis.png`: Gr√°ficos de an√°lisis principal
- `theoretical_comparison.png`: Validaci√≥n te√≥rica
- `sequential_vs_parallel_comparison.png`: Comparaci√≥n de implementaciones

### M√©tricas T√≠picas
- **Speedup m√°ximo**: ~4-6x con 8-16 procesos
- **Eficiencia √≥ptima**: ~0.7-0.8 con 2-4 procesos
- **Precisi√≥n**: ~0.97 (estable en todas las configuraciones)
- **Punto √≥ptimo**: ~4-8 procesos seg√∫n tama√±o de datos

## üî¨ Fundamentos Te√≥ricos

### Complejidad del Algoritmo
```
T(n,p) = a + (n_tr √ó n_te √ó k)/p + b√ólog(p)
```
- **a**: Latencia base
- **T√©rmino 2**: C√≥mputo distribuido O(n/p)  
- **T√©rmino 3**: Comunicaci√≥n O(log p)

### N√∫mero √ìptimo de Procesos
```
p_opt = ‚àö(C2/C3)
```
Donde C2 y C3 son coeficientes experimentales del modelo ajustado.

## üêõ Soluci√≥n de Problemas

### Error de M√≥dulos
```bash
module purge
source scripts/setup_environment.sh
```

### Memoria Insuficiente
```bash
# Reducir multiplicador de datos
sbatch --ntasks=4 scripts/knn_digits.sh 1
```

### Trabajos en Cola
```bash
# Verificar estado del cluster
sinfo
squeue

# Cancelar trabajos si es necesario
scancel JOBID
```

## üìö Referencias

- Quinn, M. J. (2003). *Parallel Programming in C with MPI and OpenMP*
- [MPI for Python Documentation](https://mpi4py.readthedocs.io/)
- [Cluster Khipu UTEC](https://docs.khipu.utec.edu.pe/)

## ü§ù Contribuciones

1. Fork el repositorio
2. Crea una rama para tu feature (`git checkout -b feature/mejora`)
3. Commit tus cambios (`git commit -am 'A√±adir nueva funcionalidad'`)
4. Push a la rama (`git push origin feature/mejora`)
5. Crea un Pull Request

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT - ver el archivo [LICENSE](LICENSE) para detalles.

## üë®‚Äçüéì Autor

**Pr√°ctica Dirigida 02 - Applied High Performance Computing**  
Universidad de Ingenier√≠a y Tecnolog√≠a (UTEC)  
Curso: CS8084 APPLIED HIGH PERFORMANCE COMPUTING
Autores: Christian Monrroy / Oscar Bueno


---

## üìä Badge de Estado

![Build Status](https://img.shields.io/badge/build-passing-brightgreen)
![Tests](https://img.shields.io/badge/tests-pending-yellow)
![Coverage](https://img.shields.io/badge/coverage-85%25-green)